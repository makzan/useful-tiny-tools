<!DOCTYPE html><html lang="en"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bulk 50% Image Resizer</title>
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #0f172a;
      background-color: #f8fafc;
    }
    body {
      margin: 0;
      padding: 1.5rem;
      display: flex;
      justify-content: center;
    }
    main {
      width: 100%;
      max-width: 960px;
      background: #ffffff;
      padding: 2rem;
      border-radius: 1.25rem;
      box-shadow: 0 20px 35px rgba(15, 23, 42, 0.08);
    }
    h1 {
      margin-top: 0;
      font-size: clamp(1.8rem, 2.4vw, 2.4rem);
    }
    p {
      color: #475569;
      margin-bottom: 1.25rem;
      line-height: 1.5;
    }
    label {
      font-weight: 600;
      display: block;
      margin-bottom: 0.75rem;
    }
    input[type="file"] {
      width: 100%;
      max-width: 420px;
      padding: 0.65rem;
    }
    #status {
      margin-top: 1rem;
      min-height: 1.5rem;
      color: #dc2626;
      font-weight: 500;
    }
    .results {
      margin-top: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .card {
      border: 1px solid #e2e8f0;
      border-radius: 1rem;
      padding: 1.25rem;
      background: #f8fafc;
      display: grid;
      gap: 1rem;
    }
    @media (min-width: 640px) {
      .card {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    .preview-block {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .preview-wrapper {
      border: 1px dashed #cbd5f5;
      border-radius: 0.75rem;
      padding: 0.5rem;
      background: #fff;
      min-height: 180px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .preview-wrapper img {
      max-width: 100%;
      height: auto;
      border-radius: 0.5rem;
    }
    .info {
      font-size: 0.9rem;
      color: #475569;
    }
    .download {
      grid-column: 1 / -1;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
    }
    .download a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.65rem 1.25rem;
      border-radius: 999px;
      background: #1d4ed8;
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.25);
    }
    .file-name {
      font-weight: 600;
      color: #0f172a;
    }
    .empty-state {
      margin-top: 2rem;
      padding: 2rem;
      border: 2px dashed #c7d2fe;
      border-radius: 1rem;
      text-align: center;
      color: #6366f1;
      background: #eef2ff;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <main>
    <h1>Bulk 50% Image Resizer</h1>
    <p>
      Select multiple photos and each will be automatically resized to 50% of its original width and height, then exported as a JPEG at 90% quality. Download every optimized image individually once processing finishes.
    </p>

    <label for="imageInput">Choose one or more images (PNG, JPEG, WEBP, GIF):</label>
    <input id="imageInput" type="file" accept="image/png,image/jpeg,image/webp,image/gif" multiple="">

    <div id="status"></div>

    <div id="results" class="results"></div>
    <div id="placeholder" class="empty-state">No images yet. Select files to begin.</div>
  </main>

  <script>
    const fileInput = document.getElementById('imageInput');
    const statusEl = document.getElementById('status');
    const resultsEl = document.getElementById('results');
    const placeholderEl = document.getElementById('placeholder');

    fileInput.addEventListener('change', async (event) => {
      const files = Array.from(event.target.files || []);
      resultsEl.innerHTML = '';
      placeholderEl.style.display = files.length ? 'none' : 'block';
      statusEl.textContent = files.length ? `Processing ${files.length} image${files.length > 1 ? 's' : ''}…` : '';
      if (!files.length) return;

      const processed = await Promise.all(files.map(processImage));
      const success = processed.filter(Boolean);
      success.forEach(renderCard);
      statusEl.textContent = success.length
        ? 'Finished! Download each resized image below.'
        : 'No images could be processed. Please try different files.';
    });

    function processImage(file) {
      return new Promise((resolve) => {
        if (!file.type.startsWith('image/')) {
          resolve(null);
          return;
        }
        const reader = new FileReader();
        reader.onload = () => {
          const img = new Image();
          img.onload = () => {
            const targetWidth = Math.max(1, Math.round(img.width * 0.5));
            const targetHeight = Math.max(1, Math.round(img.height * 0.5));
            const canvas = document.createElement('canvas');
            canvas.width = targetWidth;
            canvas.height = targetHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, targetWidth, targetHeight);
            const resizedUrl = canvas.toDataURL('image/jpeg', 0.9);
            const resizedBytes = dataURLSizeBytes(resizedUrl);
            const safeName = (file.name || 'image')
              .replace(/\.[^.]+$/, '')
              .replace(/[^\w\-]+/g, '_');
            resolve({
              originalUrl: img.src,
              originalWidth: img.width,
              originalHeight: img.height,
              originalSize: file.size,
              resizedUrl,
              resizedWidth: targetWidth,
              resizedHeight: targetHeight,
              resizedSize: resizedBytes,
              downloadName: `${safeName}_50pct.jpg`,
              originalName: file.name || 'Untitled image'
            });
          };
          img.onerror = () => resolve(null);
          img.src = reader.result;
        };
        reader.onerror = () => resolve(null);
        reader.readAsDataURL(file);
      });
    }

    function dataURLSizeBytes(dataUrl) {
      const base64 = dataUrl.split(',')[1] || '';
      const padding = (base64.match(/=+$/) || [''])[0].length;
      return Math.round(base64.length * 3 / 4 - padding);
    }

    function formatSize(bytes) {
      if (!Number.isFinite(bytes)) return 'Unknown size';
      if (bytes >= 1048576) return `${(bytes / 1048576).toFixed(2)} MB`;
      return `${(bytes / 1024).toFixed(1)} KB`;
    }

    function renderCard(data) {
      if (!data) return;
      const card = document.createElement('section');
      card.className = 'card';
      card.innerHTML = `
        <div class="preview-block">
          <div class="file-name">${data.originalName}</div>
          <div class="preview-wrapper">
            <img src="${data.originalUrl}" alt="Original preview" loading="lazy" />
          </div>
          <div class="info">Original: ${data.originalWidth} × ${data.originalHeight}px · ${formatSize(data.originalSize)}</div>
        </div>
        <div class="preview-block">
          <div class="file-name">Resized (50% · 90% JPEG)</div>
          <div class="preview-wrapper">
            <img src="${data.resizedUrl}" alt="Resized preview" loading="lazy" />
          </div>
          <div class="info">New size: ${data.resizedWidth} × ${data.resizedHeight}px · ${formatSize(data.resizedSize)}</div>
        </div>
        <div class="download">
          <a href="${data.resizedUrl}" download="${data.downloadName}">Download ${data.downloadName}</a>
        </div>
      `;
      resultsEl.appendChild(card);
    }
  </script>


</body></html>